<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="stylesheet" type="text/css" href="/styles.css" />
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css">
   <title>Chattr</title>
</head>

<body>
   <header class="pt-1 fixed-top">Chattr</header>
   <div class="container mt-5 mb-5">
      <!-- The actual messages -->
      <ul id="messages"></ul>

      <!-- The form input for the user to enter their message -->
      <div class="fixed-bottom mb-0">
         <form id="messageForm">
            <div class="input-group">
               <input type="text" class="form-control" placeholder="Your message..." id="messageBox"
                  class="form-control" autocomplete="off" aria-label="Your message" style="border-radius: 0%;" />
               <div class="input-group-append">
                  <button id="sendButton" class="btn btn-secondary w-100" style="border-radius: 0%;" type="submit">
                     <i class="bi bi-send me-2"></i>Send</button>
               </div>
            </div>
         </form>
      </div>
   </div>



   <script src="/socket.io/socket.io.js"></script>
   <script>
      var socket = io();
      var form = document.getElementById('messageForm');
      var input = document.getElementById('messageBox');

      form.addEventListener('submit', function (e) {
         e.preventDefault();

         if (input.value) {
            socket.emit('chat message', input.value);
            input.value = ""
         }
      })

      socket.on('chat message', function (msg) {
         let item = document.createElement('li');
         item.textContent = msg;
         messages.appendChild(item);
         window.scrollTo(0, document.body.scrollHeight);
      })

      socket.on('user disconnect', function () {
         let item = document.createElement('li');
         item.textContent = "User left";
         messages.appendChild(item);
         window.scrollTo(0, document.body.scrollHeight);
      })
   </script>
</body>

</html>